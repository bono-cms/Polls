<!DOCTYPE html>
<html>
<?php $this->loadBlock('head', array(
	'title' => 'Polls'
));

?>
<body>

<?php $this->loadBlock('header');?>

<section>
	
	<?php $this->loadBlock('breadcrumbs'); ?>
	<?php $this->loadBlock('flash'); ?>
	
	
	<!--Menu-->
	<div class="btn-toolbar">
		<div class="btn-group">
		  <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">
			<span class="glyphicon glyphicon-list"></span> <?php echo $this->translate('Menu'); ?>
			<span class="caret"></span>
		  </button>
		  <ul class="dropdown-menu">
			 <li><a href="/admin/module/polls/answer/add"><i class="glyphicon glyphicon-plus"></i> <?php $this->show('Add an answer'); ?></a></li>
			 <li><a href="/admin/module/polls/category/add"><i class="glyphicon glyphicon-plus"></i> <?php $this->show('Add category'); ?></a></li>
			 <li class="divider"></li>
			 <li><a href="#" id="save-changes-btn"><i class="glyphicon glyphicon-floppy-save"></i> <?php $this->show('Save changes'); ?></a></li>
			 <li><a href="#" id="remove-selected-btn" data-button="remove-selected"><i class="glyphicon glyphicon-remove"></i> <?php $this->show('Remove selected'); ?></a></li>
		  </ul>
		</div>
	</div>
	<!--Menu-->
	
	
	<?php $this->loadBlock('items-per-page', array('caption' => 'Polls')); ?>
	
	
	<div class="row">
		<div class="col-lg-6">
			<form id="post-form">
				<table class="list table-hover">
					<thead>
						<tr>
							<th><input type="checkbox" /></th>
							<th><?php $this->show('#'); ?></th>
							<th><?php $this->show('Title'); ?></th>
							<th><?php $this->show('Created'); ?></th>
							<th><?php $this->show('Category'); ?></th>
							<th><?php $this->show('Price'); ?></th>
							<th><?php $this->show('Published'); ?></th>
							<th><?php $this->show('Actions'); ?></th>
						</tr>
					</thead>
					
					<tbody>
						
						<?php if (!empty($products)):?>
						<?php foreach ($products as $product): ?>
						
						<tr>
							<td><input type="checkbox" name="toDelete[<?php echo $product->getId(); ?>]" /></td>
							<td><?php echo $product->getId(); ?></td>
							<td><?php echo $product->getTitle(); ?></td>
							<td><?php echo date('d-m-Y', time()); ?></td>
							<td><?php echo $product->getCategoryName(); ?></td>
							<td><input type="text" name="price[<?php echo $product->getId(); ?>]" value="<?php echo $product->getPrice(); ?>" /></td>
							<td>
								<?php $this->createElement('FormCheckbox', array(
									'checked' => (bool) $product->getPublished(),
									'name'	  => sprintf('published[%s]', $product->getId())
								)); ?>
							</td>
							<td>
								<a class="view" href="<?php printf('/%s/', $product->getSlug()); ?>"></a>
								<a class="edit" href="<?php printf('/admin/module/shop/product/edit/%s', $product->getId()); ?>"></a>
								<a class="delete" data-id="<?php echo $product->getId(); ?>" href="#"></a>
							</td>
						</tr>
						
						<?php endforeach; ?>
						<?php endif; ?>
						
					</tbody>
				</table>
				
			</form>
		</div>
		
		
		
		<div class="col-lg-6">
			
			<table class="list table-hover">
				<tbody>
					<tr>
						<th colspan="2">Add new option</th>
					</tr>
					
					<tr>
						<td class="h"><?php $this->show('Title'); ?></td>
						<td class="e"><input type="text" /></td>
					</tr>
					
					<tr>
						<td></td>
						<td></td>
					</tr>

					<tr>
						<td><?php $this->show('Published'); ?></td>
						<td>
							<input type="checkbox" />
						</td>
					</tr>
					
				</tbody>
			</table>
			
		</div>
		
	</div>
	
	
	<?php $this->loadBlock('paginator'); ?>
	
	<h4><i class="glyphicon glyphicon-th-list"></i><?php $this->show('Categories'); ?> (<?php echo count($categories); ?>)</h4>
	
	<form id="category-form">
		<table class="list">
			<thead>
				<tr>
					<th><?php $this->show('#'); ?></th>
					<th><?php $this->show('Name'); ?></th>
					<th><?php $this->show('Actions'); ?></th>
				</tr>
			</thead>
			
			<tbody>
				
				<?php if (!empty($categories)): ?>
				<?php foreach ($categories as $id => $category): ?>
				
				<tr>
					<td><?php echo $id; ?></td>
					<td><a href="<?php printf('/admin/module/shop/browse/category/%s', $id); ?>"><?php echo $category; ?></a></td>
					<td>
						<a data-button="edit" href="<?php printf('/admin/module/shop/category/edit/%s', $id); ?>"></a>
						<a data-button="delete" href="#"></a>
					</td>
				</tr>
				
				<?php endforeach; ?>
				<?php endif; ?>
				
			</tbody>
		</table>
	</form>
</section>

<script>
	
	$(function() {
		
		$("#save-changes-btn").click(function(event) {
			event.preventDefault();
			
			$.ajax({
				url : "/admin/module/shop/save.ajax",
				data : $("form").serialize(),
				success : function(response){
					if (response == "1") {
						window.location.reload();
					} else {
						console.log(response);
					}
				}
			});
		});
		
		
		$("#remove-selected-btn").click(function(event) {
			event.preventDefault();
			
			$.ajax({
				url : "/admin/module/shop/delete-selected.ajax",
				data : $("form").serialize(),
				success : function(response) {
					if (response == "1") {
						window.location.reload();
					} else {
						console.log(response);
					}
				}
			});
		});
		
		
	});
	
</script>

<?php $this->loadBlock('footer'); ?>

</body>
</html>
