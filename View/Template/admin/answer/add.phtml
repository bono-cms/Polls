<!DOCTYPE html>
<html>
<?php $this->loadBlock('head', array(
	'title' => 'Add an answer'
));

?>
<body>

<?php $this->loadBlock('header'); ?>

<section>
	
	<?php $this->loadBlock('breadcrumbs'); ?>
	<?php $this->loadBlock('flash'); ?>
	
	<form>
		<div class="well">
			
			<!--Answer-->
			<div class="form-group clearfix">
				<label class="col-lg-2 control-label"><?php echo $this->translate('Answer'); ?><b>*</b></label>
				<div class="col-lg-10">
					<div class="input-group">
						<input type="text" name="title" class="form-control" placeholder="<?php echo $this->translate('Target answer'); ?>" />
						<span class="input-group-addon"><i class="glyphicon glyphicon-pencil"></i></span>
					</div>
				</div>
			</div>
			<!--/Answer-->
			
			
			<!--Category id-->
			<div class="form-group clearfix">
				<label class="col-lg-2 control-label"><?php echo $this->translate('Category'); ?></label>
				<div class="col-lg-10">
					<select name="categoryId" class="form-control">
						<option value="1">None</option>
						
						<?php foreach($categories as $category): ?>
						<option value="<?php echo $category->id; ?>"><?php echo $category->name; ?></option>
						<?php endforeach; ?>
					</select>
				</div>
			</div>
			<!--/Category id-->
			
			
			<!--Order-->
			<div class="form-group clearfix">
				<label class="col-lg-2 control-label"><?php echo $this->translate('Order'); ?><b>*</b></label>
				<div class="col-lg-10">
					<div class="input-group">
						<input type="text" name="order" class="form-control" placeholder="<?php echo $this->translate('Order of this answer to be displayed in a category'); ?>" />
						<span class="input-group-addon"><i class="glyphicon glyphicon-pencil"></i></span>
					</div>
				</div>
			</div>
			<!--/Order-->
			
			
			<!--Published-->
			<div class="form-group clearfix">
				<label class="col-lg-2 control-label"><?php echo $this->translate('Published'); ?><b>*</b></label>
				<div class="col-lg-10">
					<input type="hidden" name="published" value="0" />
					<input type="checkbox" name="published" value="1" class="form-control" checked="checked" />
				</div>
			</div>
			<!--/Published-->
			
		</div>
		
		<?php $this->loadBlock('end'); ?>
		
		<button type="submit" id="add-btn" class="btn btn-primary"><span class="glyphicon glyphicon-floppy-save"></span> <?php echo $this->translate('Add'); ?></button>
		<button type="submit" id="add-create-btn" class="btn btn-primary"><span class="glyphicon glyphicon-floppy-save"></span> <?php echo $this->translate('Add & Create new'); ?></button>
		<button type="button" class="btn btn-default"><span class="glyphicon glyphicon-floppy-remove"></span> <?php echo $this->translate('Cancel'); ?></button>
		
	</form>
</section>

<?php $this->loadBlock('footer'); ?>

<script>
	
	$(function() {
		
		
		function listenSubmit(callback) {
			$("form").submit(function(event) {
				event.preventDefault();
				
				var data = $(this).serialize();
				
				$.ajax({
					url : "/admin/module/polls/answer/add.ajax",
					data : data,
					success : callback
				});
			});
		}
		
		
		
		$("#add-btn").click(function(event) {
			listenSubmit(function(response) {
				if ($.isNumeric(response)) {
					window.location = '/admin/module/polls/answer/edit/' + response;
				} else {
					console.log(response);
				}
			});
		});
		
		
		
		$("#add-create-btn").click(function(event) {
			listenSubmit(function(response) {
				if ($.isNumeric(response)) {
					window.location.reload();
				} else {
					console.log(response);
				}
			});
		});
		
		
		
	});
	
</script>

</body>
</html>